image: java:8

variables:
  MAVEN_OPTS: "-Xms128m -Xmx768m"

stages:
  - resource_check
  - compile
  - test

resource_check:
  stage: resource_check
  script: "java -XX:+PrintFlagsFinal -version | grep -iE 'HeapSize|PermSize|ThreadStackSize'"

compile:
  stage: compile
  script: "./mvnw install -DskipTests -B -V"

test:
  stage: test
  script: "./mvnw install -B -V -Dsurefire.useFile=false"